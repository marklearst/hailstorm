import{r as s}from"./iframe-B1MrCL0G.js";import{s as m}from"./bugs-WVkwHmE-.js";import{a as p,n as $,o as w}from"./use-sync-refs-BLyEwgBe.js";import{f as x,i as R,l as T,c as y}from"./keyboard-Bq9WUD44.js";import{i as v}from"./portal-VJJ9eBMU.js";var k=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(k||{});function P(e){let r=s.useRef(null),n=p(u=>{r.current=u.pointerType,!m(u.currentTarget)&&u.pointerType==="mouse"&&u.button===k.Left&&(u.preventDefault(),e(u))}),l=p(u=>{r.current!=="mouse"&&(m(u.currentTarget)||e(u))});return{onPointerDown:n,onClick:l}}var E=(e=>(e[e.Ignore=0]="Ignore",e[e.Select=1]="Select",e[e.Close=2]="Close",e))(E||{});const z={Ignore:{kind:0},Select:e=>({kind:1,target:e}),Close:{kind:2}},L=200,b=5;function H(e,{trigger:r,action:n,close:l,select:u}){let t=s.useRef(null),i=s.useRef(null),a=s.useRef(null);v(e&&r!==null,"pointerdown",o=>{x(o?.target)&&r!=null&&r.contains(o.target)&&(i.current=o.x,a.current=o.y,t.current=o.timeStamp)}),v(e&&r!==null,"pointerup",o=>{var f,c;let d=t.current;if(d===null||(t.current=null,!R(o.target))||Math.abs(o.x-((f=i.current)!=null?f:o.x))<b&&Math.abs(o.y-((c=a.current)!=null?c:o.y))<b)return;let g=n(o);switch(g.kind){case 0:return;case 1:{o.timeStamp-d>L&&(u(g.target),l());break}case 2:{l();break}}},{capture:!0})}function F(e){return[e.screenX,e.screenY]}function W(){let e=s.useRef([-1,-1]);return{wasMoved(r){let n=F(r);return e.current[0]===n[0]&&e.current[1]===n[1]?!1:(e.current=n,!0)},update(r){e.current=F(r)}}}function q(e,{container:r,accept:n,walk:l}){let u=s.useRef(n),t=s.useRef(l);s.useEffect(()=>{u.current=n,t.current=l},[n,l]),$(()=>{if(!r||!e)return;let i=T(r);if(!i)return;let a=u.current,o=t.current,f=Object.assign(d=>a(d),{acceptNode:a}),c=i.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,f,!1);for(;c.nextNode();)o(c.currentNode)},[r,e,u,t])}function N(e){throw new Error("Unexpected object: "+e)}var S=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(S||{});function U(e,r){let n=r.resolveItems();if(n.length<=0)return null;let l=r.resolveActiveIndex(),u=l??-1;switch(e.focus){case 0:{for(let t=0;t<n.length;++t)if(!r.resolveDisabled(n[t],t,n))return t;return l}case 1:{u===-1&&(u=n.length);for(let t=u-1;t>=0;--t)if(!r.resolveDisabled(n[t],t,n))return t;return l}case 2:{for(let t=u+1;t<n.length;++t)if(!r.resolveDisabled(n[t],t,n))return t;return l}case 3:{for(let t=n.length-1;t>=0;--t)if(!r.resolveDisabled(n[t],t,n))return t;return l}case 4:{for(let t=0;t<n.length;++t)if(r.resolveId(n[t],t,n)===e.id)return t;return l}case 5:return null;default:N(e)}}const X={Idle:{kind:"Idle"},Tracked:e=>({kind:"Tracked",position:e}),Moved:{kind:"Moved"}};function C(e){let r=e.getBoundingClientRect();return`${r.x},${r.y}`}function Y(e,r,n){let l=w();if(r.kind==="Tracked"){let u=function(){t!==C(e)&&(l.dispose(),n())},{position:t}=r,i=new ResizeObserver(u);i.observe(e),l.add(()=>i.disconnect()),l.addEventListener(window,"scroll",u,{passive:!0}),l.addEventListener(window,"resize",u)}return()=>l.dispose()}let h=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function D(e){var r,n;let l=(r=e.innerText)!=null?r:"",u=e.cloneNode(!0);if(!y(u))return l;let t=!1;for(let a of u.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))a.remove(),t=!0;let i=t?(n=u.innerText)!=null?n:"":l;return h.test(i)&&(i=i.replace(h,"")),i}function I(e){let r=e.getAttribute("aria-label");if(typeof r=="string")return r.trim();let n=e.getAttribute("aria-labelledby");if(n){let l=n.split(" ").map(u=>{let t=document.getElementById(u);if(t){let i=t.getAttribute("aria-label");return typeof i=="string"?i.trim():D(t).trim()}return null}).filter(Boolean);if(l.length>0)return l.join(", ")}return D(e).trim()}function _(e){let r=s.useRef(""),n=s.useRef("");return p(()=>{let l=e.current;if(!l)return"";let u=l.innerText;if(r.current===u)return n.current;let t=I(l).trim().toLowerCase();return r.current=u,n.current=t,t})}export{q as F,H as L,z as S,S as a,C as b,X as c,_ as d,U as f,k as g,Y as p,P as s,W as u};
