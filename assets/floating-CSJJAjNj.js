import{r,h as ae}from"./iframe-XRykOgCy.js";import{n as I,o as fe,a as le,p as ge}from"./use-sync-refs-Bo2Xpa_i.js";import{u as me,i as O,e as de,o as se,d as N,m as Y,r as pe,b as he,s as ve,f as xe,c as Re,a as Ce}from"./floating-ui.react-dom-DsQUudfM.js";import{r as V}from"./index-hh3hN7OQ.js";import{c as be}from"./keyboard-e8CRX24o.js";function X(e){if(e===null)return{width:0,height:0};let{width:t,height:o}=e.getBoundingClientRect();return{width:t,height:o}}function Ge(e,t,o=!1){let[n,l]=r.useState(()=>X(t));return I(()=>{if(!t||!e)return;let u=fe();return u.requestAnimationFrame(function a(){u.requestAnimationFrame(a),l(s=>{let f=X(t);return f.width===s.width&&f.height===s.height?s:f})}),()=>{u.dispose()}},[t,e]),o?{width:`${n.width}px`,height:`${n.height}px`}:n}function we(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:o,version:n}=t;return o+"/"+n}).join(" "):navigator.userAgent}const ie={...ae},ye=ie.useInsertionEffect,Fe=ye||(e=>e());function ce(e){const t=r.useRef(()=>{});return Fe(()=>{t.current=e}),r.useCallback(function(){for(var o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];return t.current==null?void 0:t.current(...n)},[])}var W=typeof document<"u"?r.useLayoutEffect:r.useEffect;let L=!1,Ee=0;const Z=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Ee++;function Se(){const[e,t]=r.useState(()=>L?Z():void 0);return W(()=>{e==null&&t(Z())},[]),r.useEffect(()=>{L=!0},[]),e}const Te=ie.useId,Me=Te||Se;function Ie(){const e=new Map;return{emit(t,o){var n;(n=e.get(t))==null||n.forEach(l=>l(o))},on(t,o){e.set(t,[...e.get(t)||[],o])},off(t,o){var n;e.set(t,((n=e.get(t))==null?void 0:n.filter(l=>l!==o))||[])}}}const Pe=r.createContext(null),Ae=r.createContext(null),He=()=>{var e;return((e=r.useContext(Pe))==null?void 0:e.id)||null},Oe=()=>r.useContext(Ae),$e="data-floating-ui-focusable";function De(e){const{open:t=!1,onOpenChange:o,elements:n}=e,l=Me(),u=r.useRef({}),[a]=r.useState(()=>Ie()),s=He()!=null,[f,g]=r.useState(n.reference),p=ce((c,i,m)=>{u.current.openEvent=c?i:void 0,a.emit("openchange",{open:c,event:i,reason:m,nested:s}),o?.(c,i,m)}),x=r.useMemo(()=>({setPositionReference:g}),[]),v=r.useMemo(()=>({reference:f||n.reference||null,floating:n.floating||null,domReference:n.reference}),[f,n.reference,n.floating]);return r.useMemo(()=>({dataRef:u,open:t,onOpenChange:p,elements:v,events:a,floatingId:l,refs:x}),[t,p,v,a,l,x])}function Be(e){e===void 0&&(e={});const{nodeId:t}=e,o=De({...e,elements:{reference:null,floating:null,...e.elements}}),n=e.rootContext||o,l=n.elements,[u,a]=r.useState(null),[s,f]=r.useState(null),p=l?.domReference||u,x=r.useRef(null),v=Oe();W(()=>{p&&(x.current=p)},[p]);const c=me({...e,elements:{...l,...s&&{reference:s}}}),i=r.useCallback(d=>{const C=O(d)?{getBoundingClientRect:()=>d.getBoundingClientRect(),contextElement:d}:d;f(C),c.refs.setReference(C)},[c.refs]),m=r.useCallback(d=>{(O(d)||d===null)&&(x.current=d,a(d)),(O(c.refs.reference.current)||c.refs.reference.current===null||d!==null&&!O(d))&&c.refs.setReference(d)},[c.refs]),h=r.useMemo(()=>({...c.refs,setReference:m,setPositionReference:i,domReference:x}),[c.refs,m,i]),R=r.useMemo(()=>({...c.elements,domReference:p}),[c.elements,p]),b=r.useMemo(()=>({...c,...n,refs:h,elements:R,nodeId:t}),[c,h,R,t,n]);return W(()=>{n.dataRef.current.floatingContext=b;const d=v?.nodesRef.current.find(C=>C.id===t);d&&(d.context=b)}),r.useMemo(()=>({...c,context:b,refs:h,elements:R}),[c,h,R,b])}const ee="active",te="selected";function q(e,t,o){const n=new Map,l=o==="item";let u=e;if(l&&e){const{[ee]:a,[te]:s,...f}=e;u=f}return{...o==="floating"&&{tabIndex:-1,[$e]:""},...u,...t.map(a=>{const s=a?a[o]:null;return typeof s=="function"?e?s(e):null:s}).concat(e).reduce((a,s)=>(s&&Object.entries(s).forEach(f=>{let[g,p]=f;if(!(l&&[ee,te].includes(g)))if(g.indexOf("on")===0){if(n.has(g)||n.set(g,[]),typeof p=="function"){var x;(x=n.get(g))==null||x.push(p),a[g]=function(){for(var v,c=arguments.length,i=new Array(c),m=0;m<c;m++)i[m]=arguments[m];return(v=n.get(g))==null?void 0:v.map(h=>h(...i)).find(h=>h!==void 0)}}}else a[g]=p}),a),{})}}function Ne(e){e===void 0&&(e=[]);const t=e.map(s=>s?.reference),o=e.map(s=>s?.floating),n=e.map(s=>s?.item),l=r.useCallback(s=>q(s,e,"reference"),t),u=r.useCallback(s=>q(s,e,"floating"),o),a=r.useCallback(s=>q(s,e,"item"),n);return r.useMemo(()=>({getReferenceProps:l,getFloatingProps:u,getItemProps:a}),[l,u,a])}function ne(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const Ye=e=>({name:"inner",options:e,async fn(t){const{listRef:o,overflowRef:n,onFallbackChange:l,offset:u=0,index:a=0,minItemsVisible:s=4,referenceOverflowThreshold:f=0,scrollRef:g,...p}=de(e,t),{rects:x,elements:{floating:v}}=t,c=o.current[a],i=g?.current||v,m=v.clientTop||i.clientTop,h=v.clientTop!==0,R=i.clientTop!==0,b=v===i;if(!c)return{};const d={...t,...await se(-c.offsetTop-v.clientTop-x.reference.height/2-c.offsetHeight/2-u).fn(t)},C=await N(ne(d,i.scrollHeight+m+v.clientTop),p),y=await N(d,{...p,elementContext:"reference"}),F=Y(0,C.top),P=d.y+F,$=(i.scrollHeight>i.clientHeight?w=>w:pe)(Y(0,i.scrollHeight+(h&&b||R?m*2:0)-F-Y(0,C.bottom)));if(i.style.maxHeight=$+"px",i.scrollTop=F,l){const w=i.offsetHeight<c.offsetHeight*he(s,o.current.length)-1||y.top>=-f||y.bottom>=-f;V.flushSync(()=>l(w))}return n&&(n.current=await N(ne({...d,y:P},i.offsetHeight+m+v.clientTop),p)),{y:P}}});function qe(e,t){const{open:o,elements:n}=e,{enabled:l=!0,overflowRef:u,scrollRef:a,onChange:s}=t,f=ce(s),g=r.useRef(!1),p=r.useRef(null),x=r.useRef(null);r.useEffect(()=>{if(!l)return;function c(m){if(m.ctrlKey||!i||u.current==null)return;const h=m.deltaY,R=u.current.top>=-.5,b=u.current.bottom>=-.5,d=i.scrollHeight-i.clientHeight,C=h<0?-1:1,y=h<0?"max":"min";i.scrollHeight<=i.clientHeight||(!R&&h>0||!b&&h<0?(m.preventDefault(),V.flushSync(()=>{f(F=>F+Math[y](h,d*C))})):/firefox/i.test(we())&&(i.scrollTop+=h))}const i=a?.current||n.floating;if(o&&i)return i.addEventListener("wheel",c),requestAnimationFrame(()=>{p.current=i.scrollTop,u.current!=null&&(x.current={...u.current})}),()=>{p.current=null,x.current=null,i.removeEventListener("wheel",c)}},[l,o,n.floating,u,a,f]);const v=r.useMemo(()=>({onKeyDown(){g.current=!0},onWheel(){g.current=!1},onPointerMove(){g.current=!1},onScroll(){const c=a?.current||n.floating;if(!(!u.current||!c||!g.current)){if(p.current!==null){const i=c.scrollTop-p.current;(u.current.bottom<-.5&&i<-1||u.current.top<-.5&&i>1)&&V.flushSync(()=>f(m=>m+i))}requestAnimationFrame(()=>{p.current=c.scrollTop})}}}),[n.floating,f,u,a]);return r.useMemo(()=>l?{floating:v}:{},[l,v])}let T=r.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});T.displayName="FloatingContext";let j=r.createContext(null);j.displayName="PlacementContext";function Je(e){return r.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function ze(){return r.useContext(T).setReference}function Qe(){return r.useContext(T).getReferenceProps}function Xe(){let{getFloatingProps:e,slot:t}=r.useContext(T);return r.useCallback((...o)=>Object.assign({},e(...o),{"data-anchor":t.anchor}),[e,t])}function Le(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let t=r.useContext(j),o=r.useMemo(()=>e,[JSON.stringify(e,(l,u)=>{var a;return(a=u?.outerHTML)!=null?a:u})]);I(()=>{t?.(o??null)},[t,o]);let n=r.useContext(T);return r.useMemo(()=>[n.setFloating,e?n.styles:{}],[n.setFloating,e,n.styles])}let oe=4;function Ze({children:e,enabled:t=!0}){let[o,n]=r.useState(null),[l,u]=r.useState(0),a=r.useRef(null),[s,f]=r.useState(null);Ue(s);let g=t&&o!==null&&s!==null,{to:p="bottom",gap:x=0,offset:v=0,padding:c=0,inner:i}=Ve(o,s),[m,h="center"]=p.split(" ");I(()=>{g&&u(0)},[g]);let{refs:R,floatingStyles:b,context:d}=Be({open:g,placement:m==="selection"?h==="center"?"bottom":`bottom-${h}`:h==="center"?`${m}`:`${m}-${h}`,strategy:"absolute",transform:!1,middleware:[se({mainAxis:m==="selection"?0:x,crossAxis:v}),ve({padding:c}),m!=="selection"&&xe({padding:c}),m==="selection"&&i?Ye({...i,padding:c,overflowRef:a,offset:l,minItemsVisible:oe,referenceOverflowThreshold:c,onFallbackChange(w){var A,H;if(!w)return;let M=d.elements.floating;if(!M)return;let K=parseFloat(getComputedStyle(M).scrollPaddingBottom)||0,D=Math.min(oe,M.childElementCount),G=0,J=0;for(let E of(H=(A=d.elements.floating)==null?void 0:A.childNodes)!=null?H:[])if(be(E)){let S=E.offsetTop,z=S+E.clientHeight+K,B=M.scrollTop,Q=B+M.clientHeight;if(S>=B&&z<=Q)D--;else{J=Math.max(0,Math.min(z,Q)-Math.max(S,B)),G=E.clientHeight;break}}D>=1&&u(E=>{let S=G*D-J+K;return E>=S?E:S})}}):null,Re({padding:c,apply({availableWidth:w,availableHeight:A,elements:H}){Object.assign(H.floating.style,{overflow:"auto",maxWidth:`${w}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${A}px)`})}})].filter(Boolean),whileElementsMounted:Ce}),[C=m,y=h]=d.placement.split("-");m==="selection"&&(C="selection");let F=r.useMemo(()=>({anchor:[C,y].filter(Boolean).join(" ")}),[C,y]),P=qe(d,{overflowRef:a,onChange:u}),{getReferenceProps:k,getFloatingProps:_}=Ne([P]),$=le(w=>{f(w),R.setFloating(w)});return r.createElement(j.Provider,{value:n},r.createElement(T.Provider,{value:{setFloating:$,setReference:R.setReference,styles:b,getReferenceProps:k,getFloatingProps:_,slot:F}},e))}function Ue(e){I(()=>{if(!e)return;let t=new MutationObserver(()=>{let o=window.getComputedStyle(e).maxHeight,n=parseFloat(o);if(isNaN(n))return;let l=parseInt(o);isNaN(l)||n!==l&&(e.style.maxHeight=`${Math.ceil(n)}px`)});return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[e])}function Ve(e,t){var o,n,l;let u=U((o=e?.gap)!=null?o:"var(--anchor-gap, 0)",t),a=U((n=e?.offset)!=null?n:"var(--anchor-offset, 0)",t),s=U((l=e?.padding)!=null?l:"var(--anchor-padding, 0)",t);return{...e,gap:u,offset:a,padding:s}}function U(e,t,o=void 0){let n=ge(),l=le((f,g)=>{if(f==null)return[o,null];if(typeof f=="number")return[f,null];if(typeof f=="string"){if(!g)return[o,null];let p=re(f,g);return[p,x=>{let v=ue(f);{let c=v.map(i=>window.getComputedStyle(g).getPropertyValue(i));n.requestAnimationFrame(function i(){n.nextFrame(i);let m=!1;for(let[R,b]of v.entries()){let d=window.getComputedStyle(g).getPropertyValue(b);if(c[R]!==d){c[R]=d,m=!0;break}}if(!m)return;let h=re(f,g);p!==h&&(x(h),p=h)})}return n.dispose}]}return[o,null]}),u=r.useMemo(()=>l(e,t)[0],[e,t]),[a=u,s]=r.useState();return I(()=>{let[f,g]=l(e,t);if(s(f),!!g)return g(s)},[e,t]),a}function ue(e){let t=/var\((.*)\)/.exec(e);if(t){let o=t[1].indexOf(",");if(o===-1)return[t[1]];let n=t[1].slice(0,o).trim(),l=t[1].slice(o+1).trim();return l?[n,...ue(l)]:[n]}return[]}function re(e,t){let o=document.createElement("div");t.appendChild(o),o.style.setProperty("margin-top","0px","important"),o.style.setProperty("margin-top",e,"important");let n=parseFloat(window.getComputedStyle(o).marginTop)||0;return t.removeChild(o),n}export{Ze as A,ze as F,Le as R,Xe as T,Qe as b,Ge as w,Je as y};
